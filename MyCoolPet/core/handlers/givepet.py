from aiogram import types
from ..db import db, pets
from .confog import *


async def give_pet(message: types.Message):  
    user_id = message.from_user.id
    name = message.from_user.full_name
    user = message.from_user.username
    await db.insert_user(user_id, name, user)
    if await db.get_ban(user_id) == 1:
        await message.answer('—Ç—ã –≤ –±–∞–Ω–µüí•')
        return
    if not message.reply_to_message:
        await message.answer('—Ç—ã –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ')
        return
    player_id = message.reply_to_message.from_user.id
    name2 = message.reply_to_message.from_user.full_name
    user2 = message.reply_to_message.from_user.username
    await db.insert_user(player_id, name2, user2)
    if await db.get_ban(player_id) == 1:
        await message.answer('–±–µ–¥–Ω—ã–º –Ω—É–∂–Ω–µ–µ, –Ω–µ —Ç–æ —á—Ç–æ –∑–∞–±–∞–Ω–µ–Ω—ã–º')
        return
    if message.reply_to_message.from_user.is_bot:
        await message.answer('‚ùå')
        return
    if player_id == user_id:
        await message.answer('–∞ –ª–æ–≤–∫–æ —Ç—ã —ç—Ç–æ –ø—Ä–∏–¥—É–º–∞–ª')
        return
    try:     
        idpet = message.text.split()[1]
        
        try:
            idpet = int(idpet)
            
            if idpet == 1: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.butterfly(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 1: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.butterfly(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.butterfly(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_butterfly(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_butterfly(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 2: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.butterflyG(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 2: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.butterflyG(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.butterflyG(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_butterflyG(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_butterflyG(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 3: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.dog(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 3: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.dog(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.dog(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_dog(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_dog(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 4: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.dogG(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 2: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.dogG(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.dogG(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_dogG(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_dogG(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 5: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.pig(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 5: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.pig(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.pig(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_pig(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_pig(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 6: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.pigG(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 6: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.pigG(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.pigG(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_pigG(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_pigG(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')

            elif idpet == 7: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.pumpkin(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 7: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.pumpkin(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.pumpkin(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_pumpkin(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_pumpkin(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')    

            elif idpet == 8: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.cow(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 8: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.cow(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.cow(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_cow(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_cow(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')  

            elif idpet == 9: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.cowG(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 9: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.cowG(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.cowG(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_cowG(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_cowG(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')    

            elif idpet == 10: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.vipP(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    await message.answer('–¥–∞–Ω–Ω–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –Ω–µ–ª—å–∑—è –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå') 

            elif idpet == 11: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.lugia(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 11: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.lugia(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.lugia(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_lugia(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_lugia(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')  

            elif idpet == 12: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.bulbos(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 12: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.bulbos(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.bulbos(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_bulbos(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_bulbos(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')  

            elif idpet == 13: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.tortank(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 13: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.tortank(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.tortank(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_tortank(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_tortank(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå') 

            elif idpet == 14: #–∏–∑–º–µ–Ω–∏—Ç—å
                if await pets.skwirt(user_id) > 0: #–∏–∑–º–µ–Ω–∏—Ç—å
                    if await pets.get_wearpet(user_id) != 14: #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 = await pets.skwirt(user_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet2 = await pets.skwirt(player_id) #–∏–∑–º–µ–Ω–∏—Ç—å
                        pet1 -= 1
                        pet2 += 1
                        await pets.update_skwirtl(user_id, pet1) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await pets.update_skwirtl(player_id, pet2) #–∏–∑–º–µ–Ω–∏—Ç—å
                        await message.answer(f'<b>{name}</b> –ø–µ—Ä–µ–¥–∞–ª <b>{pets_id[idpet]}</b> –∏–≥—Ä–æ–∫—É <b>{name2}</b>‚úÖ', parse_mode='HTML')
                    else:
                        await message.reply('–æ–¥–µ–Ω—å –¥—Ä—É–≥–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå')
                else:
                    await message.reply('—É —Ç–µ–±—è –Ω–µ—Ç—É —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞‚ùå') 

            else:
                if idpet > pets_all or idpet < 1:
                    await message.answer('ID —Ç–∞–∫–æ–≥–æ –ø–∏—Ç–æ–º—Ü–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç‚ùå')
                    return

        except ValueError:
            await message.answer('ID –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º')
    except IndexError:
        await message.answer('—Ç—ã –Ω–µ –≤–≤–µ–ª ID –ø–∏—Ç–æ–º—Ü–∞')